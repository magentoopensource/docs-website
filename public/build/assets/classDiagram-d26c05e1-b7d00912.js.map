{"version":3,"file":"classDiagram-d26c05e1-b7d00912.js","sources":["../../../node_modules/mermaid/dist/classDiagram-d26c05e1.js"],"sourcesContent":["import { p as parser, d as db, s as styles } from \"./styles-a893c203.js\";\nimport { select } from \"d3\";\nimport { layout } from \"dagre-d3-es/src/dagre/index.js\";\nimport * as graphlib from \"dagre-d3-es/src/graphlib/index.js\";\nimport { c as getConfig, l as log, i as configureSvgSize } from \"./mermaid-aad43469.js\";\nimport { s as svgDraw } from \"./svgDraw-95adee0a.js\";\nimport \"ts-dedent\";\nimport \"dayjs\";\nimport \"@braintree/sanitize-url\";\nimport \"dompurify\";\nimport \"khroma\";\nimport \"lodash-es/memoize.js\";\nimport \"stylis\";\nimport \"lodash-es/isEmpty.js\";\nlet idCache = {};\nconst padding = 20;\nconst getGraphId = function(label) {\n  const foundEntry = Object.entries(idCache).find((entry) => entry[1].label === label);\n  if (foundEntry) {\n    return foundEntry[0];\n  }\n};\nconst insertMarkers = function(elem) {\n  elem.append(\"defs\").append(\"marker\").attr(\"id\", \"extensionStart\").attr(\"class\", \"extension\").attr(\"refX\", 0).attr(\"refY\", 7).attr(\"markerWidth\", 190).attr(\"markerHeight\", 240).attr(\"orient\", \"auto\").append(\"path\").attr(\"d\", \"M 1,7 L18,13 V 1 Z\");\n  elem.append(\"defs\").append(\"marker\").attr(\"id\", \"extensionEnd\").attr(\"refX\", 19).attr(\"refY\", 7).attr(\"markerWidth\", 20).attr(\"markerHeight\", 28).attr(\"orient\", \"auto\").append(\"path\").attr(\"d\", \"M 1,1 V 13 L18,7 Z\");\n  elem.append(\"defs\").append(\"marker\").attr(\"id\", \"compositionStart\").attr(\"class\", \"extension\").attr(\"refX\", 0).attr(\"refY\", 7).attr(\"markerWidth\", 190).attr(\"markerHeight\", 240).attr(\"orient\", \"auto\").append(\"path\").attr(\"d\", \"M 18,7 L9,13 L1,7 L9,1 Z\");\n  elem.append(\"defs\").append(\"marker\").attr(\"id\", \"compositionEnd\").attr(\"refX\", 19).attr(\"refY\", 7).attr(\"markerWidth\", 20).attr(\"markerHeight\", 28).attr(\"orient\", \"auto\").append(\"path\").attr(\"d\", \"M 18,7 L9,13 L1,7 L9,1 Z\");\n  elem.append(\"defs\").append(\"marker\").attr(\"id\", \"aggregationStart\").attr(\"class\", \"extension\").attr(\"refX\", 0).attr(\"refY\", 7).attr(\"markerWidth\", 190).attr(\"markerHeight\", 240).attr(\"orient\", \"auto\").append(\"path\").attr(\"d\", \"M 18,7 L9,13 L1,7 L9,1 Z\");\n  elem.append(\"defs\").append(\"marker\").attr(\"id\", \"aggregationEnd\").attr(\"refX\", 19).attr(\"refY\", 7).attr(\"markerWidth\", 20).attr(\"markerHeight\", 28).attr(\"orient\", \"auto\").append(\"path\").attr(\"d\", \"M 18,7 L9,13 L1,7 L9,1 Z\");\n  elem.append(\"defs\").append(\"marker\").attr(\"id\", \"dependencyStart\").attr(\"class\", \"extension\").attr(\"refX\", 0).attr(\"refY\", 7).attr(\"markerWidth\", 190).attr(\"markerHeight\", 240).attr(\"orient\", \"auto\").append(\"path\").attr(\"d\", \"M 5,7 L9,13 L1,7 L9,1 Z\");\n  elem.append(\"defs\").append(\"marker\").attr(\"id\", \"dependencyEnd\").attr(\"refX\", 19).attr(\"refY\", 7).attr(\"markerWidth\", 20).attr(\"markerHeight\", 28).attr(\"orient\", \"auto\").append(\"path\").attr(\"d\", \"M 18,7 L9,13 L14,7 L9,1 Z\");\n};\nconst draw = function(text, id, _version, diagObj) {\n  const conf = getConfig().class;\n  idCache = {};\n  log.info(\"Rendering diagram \" + text);\n  const securityLevel = getConfig().securityLevel;\n  let sandboxElement;\n  if (securityLevel === \"sandbox\") {\n    sandboxElement = select(\"#i\" + id);\n  }\n  const root = securityLevel === \"sandbox\" ? select(sandboxElement.nodes()[0].contentDocument.body) : select(\"body\");\n  const diagram2 = root.select(`[id='${id}']`);\n  insertMarkers(diagram2);\n  const g = new graphlib.Graph({\n    multigraph: true\n  });\n  g.setGraph({\n    isMultiGraph: true\n  });\n  g.setDefaultEdgeLabel(function() {\n    return {};\n  });\n  const classes = diagObj.db.getClasses();\n  const keys = Object.keys(classes);\n  for (const key of keys) {\n    const classDef = classes[key];\n    const node = svgDraw.drawClass(diagram2, classDef, conf, diagObj);\n    idCache[node.id] = node;\n    g.setNode(node.id, node);\n    log.info(\"Org height: \" + node.height);\n  }\n  const relations = diagObj.db.getRelations();\n  relations.forEach(function(relation) {\n    log.info(\n      \"tjoho\" + getGraphId(relation.id1) + getGraphId(relation.id2) + JSON.stringify(relation)\n    );\n    g.setEdge(\n      getGraphId(relation.id1),\n      getGraphId(relation.id2),\n      {\n        relation\n      },\n      relation.title || \"DEFAULT\"\n    );\n  });\n  const notes = diagObj.db.getNotes();\n  notes.forEach(function(note) {\n    log.debug(`Adding note: ${JSON.stringify(note)}`);\n    const node = svgDraw.drawNote(diagram2, note, conf, diagObj);\n    idCache[node.id] = node;\n    g.setNode(node.id, node);\n    if (note.class && note.class in classes) {\n      g.setEdge(\n        note.id,\n        getGraphId(note.class),\n        {\n          relation: {\n            id1: note.id,\n            id2: note.class,\n            relation: {\n              type1: \"none\",\n              type2: \"none\",\n              lineType: 10\n            }\n          }\n        },\n        \"DEFAULT\"\n      );\n    }\n  });\n  layout(g);\n  g.nodes().forEach(function(v) {\n    if (v !== void 0 && g.node(v) !== void 0) {\n      log.debug(\"Node \" + v + \": \" + JSON.stringify(g.node(v)));\n      root.select(\"#\" + (diagObj.db.lookUpDomId(v) || v)).attr(\n        \"transform\",\n        \"translate(\" + (g.node(v).x - g.node(v).width / 2) + \",\" + (g.node(v).y - g.node(v).height / 2) + \" )\"\n      );\n    }\n  });\n  g.edges().forEach(function(e) {\n    if (e !== void 0 && g.edge(e) !== void 0) {\n      log.debug(\"Edge \" + e.v + \" -> \" + e.w + \": \" + JSON.stringify(g.edge(e)));\n      svgDraw.drawEdge(diagram2, g.edge(e), g.edge(e).relation, conf, diagObj);\n    }\n  });\n  const svgBounds = diagram2.node().getBBox();\n  const width = svgBounds.width + padding * 2;\n  const height = svgBounds.height + padding * 2;\n  configureSvgSize(diagram2, height, width, conf.useMaxWidth);\n  const vBox = `${svgBounds.x - padding} ${svgBounds.y - padding} ${width} ${height}`;\n  log.debug(`viewBox ${vBox}`);\n  diagram2.attr(\"viewBox\", vBox);\n};\nconst renderer = {\n  draw\n};\nconst diagram = {\n  parser,\n  db,\n  renderer,\n  styles,\n  init: (cnf) => {\n    if (!cnf.class) {\n      cnf.class = {};\n    }\n    cnf.class.arrowMarkerAbsolute = cnf.arrowMarkerAbsolute;\n    db.clear();\n  }\n};\nexport {\n  diagram\n};\n"],"names":["idCache","getGraphId","label","foundEntry","Object","entries","find","entry","diagram","parser","db","renderer","draw","text","id","_version","diagObj","conf","getConfig","class","log$1","info","securityLevel","sandboxElement","select","root","nodes","contentDocument","body","diagram2","elem","append","attr","g","graphlib.Graph","multigraph","setGraph","isMultiGraph","setDefaultEdgeLabel","classes","getClasses","keys","key","classDef","node","svgDraw","drawClass","setNode","height","getRelations","forEach","relation","id1","id2","JSON","stringify","setEdge","title","getNotes","note","log","debug","drawNote","type1","type2","lineType","layout","v","lookUpDomId","x","width","y","edges","e","edge","w","drawEdge","svgBounds","getBBox","padding","configureSvgSize","useMaxWidth","vBox","styles","init","cnf","arrowMarkerAbsolute","clear"],"mappings":"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","x_google_ignoreList":[0]}