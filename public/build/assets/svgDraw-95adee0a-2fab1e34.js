import{q as t,I as e,C as i,l as a,J as n}from"./mermaid-2a128eb4.js";let r=0;const d=function(t){let e=t.id;return t.type&&(e+="<"+t.type+">"),e},s=function(t){let e="",i="",a="",r="",d=t.substring(0,1),s=t.substring(t.length-1,t.length);d.match(/[#+~-]/)&&(r=d);let o=/[\s\w)~]/;s.match(o)||(i=l(s));const c=""===r?0:1;let p=""===i?t.length:t.length-1;const g=(t=t.substring(c,p)).indexOf("("),h=t.indexOf(")");if(g>1&&h>g&&h<=t.length){let d=t.substring(0,g).trim();const s=t.substring(g+1,h);if(e=r+d+"("+n(s.trim())+")",h<t.length){let r=t.substring(h+1,h+2);""!==i||r.match(o)?a=t.substring(h+1).trim():(i=l(r),a=t.substring(h+2).trim()),""!==a&&(":"===a.charAt(0)&&(a=a.substring(1).trim()),a=" : "+n(a),e+=a)}}else e=r+n(t);return{displayText:e,cssStyle:i}},o=function(t,e,i,a){let n=s(e);const r=t.append("tspan").attr("x",a.padding).text(n.displayText);""!==n.cssStyle&&r.attr("style",n.cssStyle),i||r.attr("dy",a.textHeight)},l=function(t){switch(t){case"*":return"font-style:italic;";case"$":return"text-decoration:underline;";default:return""}},c={getClassTitleString:d,drawClass:function(t,e,i,n){a.debug("Rendering class ",e,i);const r=e.id,s={id:r,label:e.id,width:0,height:0},l=t.append("g").attr("id",n.db.lookUpDomId(r)).attr("class","classGroup");let c;c=e.link?l.append("svg:a").attr("xlink:href",e.link).attr("target",e.linkTarget).append("text").attr("y",i.textHeight+i.padding).attr("x",0):l.append("text").attr("y",i.textHeight+i.padding).attr("x",0);let p=!0;e.annotations.forEach(function(t){const e=c.append("tspan").text("«"+t+"»");p||e.attr("dy",i.textHeight),p=!1});let g=d(e);const h=c.append("tspan").text(g).attr("class","title");p||h.attr("dy",i.textHeight);const x=c.node().getBBox().height,y=l.append("line").attr("x1",0).attr("y1",i.padding+x+i.dividerMargin/2).attr("y2",i.padding+x+i.dividerMargin/2),u=l.append("text").attr("x",i.padding).attr("y",x+i.dividerMargin+i.textHeight).attr("fill","white").attr("class","classText");p=!0,e.members.forEach(function(t){o(u,t,p,i),p=!1});const f=u.node().getBBox(),b=l.append("line").attr("x1",0).attr("y1",i.padding+x+i.dividerMargin+f.height).attr("y2",i.padding+x+i.dividerMargin+f.height),w=l.append("text").attr("x",i.padding).attr("y",x+2*i.dividerMargin+f.height+i.textHeight).attr("fill","white").attr("class","classText");p=!0,e.methods.forEach(function(t){o(w,t,p,i),p=!1});const m=l.node().getBBox();var T=" ";e.cssClasses.length>0&&(T+=e.cssClasses.join(" "));const B=l.insert("rect",":first-child").attr("x",0).attr("y",0).attr("width",m.width+2*i.padding).attr("height",m.height+i.padding+.5*i.dividerMargin).attr("class",T).node().getBBox().width;return c.node().childNodes.forEach(function(t){t.setAttribute("x",(B-t.getBBox().width)/2)}),e.tooltip&&c.insert("title").text(e.tooltip),y.attr("x2",B),b.attr("x2",B),s.width=B,s.height=m.height+i.padding+.5*i.dividerMargin,s},drawEdge:function(n,d,s,o,l){const c=function(t){switch(t){case l.db.relationType.AGGREGATION:return"aggregation";case l.db.relationType.EXTENSION:return"extension";case l.db.relationType.COMPOSITION:return"composition";case l.db.relationType.DEPENDENCY:return"dependency";case l.db.relationType.LOLLIPOP:return"lollipop"}};d.points=d.points.filter(t=>!Number.isNaN(t.y));const p=d.points,g=t().x(function(t){return t.x}).y(function(t){return t.y}).curve(e),h=n.append("path").attr("d",g(p)).attr("id","edge"+r).attr("class","relation");let x,y,u="";o.arrowMarkerAbsolute&&(u=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,u=u.replace(/\(/g,"\\("),u=u.replace(/\)/g,"\\)")),1==s.relation.lineType&&h.attr("class","relation dashed-line"),10==s.relation.lineType&&h.attr("class","relation dotted-line"),"none"!==s.relation.type1&&h.attr("marker-start","url("+u+"#"+c(s.relation.type1)+"Start)"),"none"!==s.relation.type2&&h.attr("marker-end","url("+u+"#"+c(s.relation.type2)+"End)");const f=d.points.length;let b,w,m,T,B=i.calcLabelPosition(d.points);if(x=B.x,y=B.y,f%2!=0&&f>1){let t=i.calcCardinalityPosition("none"!==s.relation.type1,d.points,d.points[0]),e=i.calcCardinalityPosition("none"!==s.relation.type2,d.points,d.points[f-1]);a.debug("cardinality_1_point "+JSON.stringify(t)),a.debug("cardinality_2_point "+JSON.stringify(e)),b=t.x,w=t.y,m=e.x,T=e.y}if(void 0!==s.title){const t=n.append("g").attr("class","classLabel"),e=t.append("text").attr("class","label").attr("x",x).attr("y",y).attr("fill","red").attr("text-anchor","middle").text(s.title);window.label=e;const i=e.node().getBBox();t.insert("rect",":first-child").attr("class","box").attr("x",i.x-o.padding/2).attr("y",i.y-o.padding/2).attr("width",i.width+o.padding).attr("height",i.height+o.padding)}if(a.info("Rendering relation "+JSON.stringify(s)),void 0!==s.relationTitle1&&"none"!==s.relationTitle1){n.append("g").attr("class","cardinality").append("text").attr("class","type1").attr("x",b).attr("y",w).attr("fill","black").attr("font-size","6").text(s.relationTitle1)}if(void 0!==s.relationTitle2&&"none"!==s.relationTitle2){n.append("g").attr("class","cardinality").append("text").attr("class","type2").attr("x",m).attr("y",T).attr("fill","black").attr("font-size","6").text(s.relationTitle2)}r++},drawNote:function(t,e,i,n){a.debug("Rendering note ",e,i);const r=e.id,d={id:r,text:e.text,width:0,height:0},s=t.append("g").attr("id",r).attr("class","classGroup");let o=s.append("text").attr("y",i.textHeight+i.padding).attr("x",0);const l=JSON.parse(`"${e.text}"`).split("\n");l.forEach(function(t){a.debug(`Adding line: ${t}`),o.append("tspan").text(t).attr("class","title").attr("dy",i.textHeight)});const c=s.node().getBBox(),p=s.insert("rect",":first-child").attr("x",0).attr("y",0).attr("width",c.width+2*i.padding).attr("height",c.height+l.length*i.textHeight+i.padding+.5*i.dividerMargin).node().getBBox().width;return o.node().childNodes.forEach(function(t){t.setAttribute("x",(p-t.getBBox().width)/2)}),d.width=p,d.height=c.height+l.length*i.textHeight+i.padding+.5*i.dividerMargin,d},parseMember:s};export{s as p,c as s};
