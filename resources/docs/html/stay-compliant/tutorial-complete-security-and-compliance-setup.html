
<h1 class="text-4xl font-bold text-charcoal mb-6">Complete Security and Compliance Setup</h1>

<div class="flex flex-wrap items-center gap-3 mb-8">
    <span class="inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium bg-orange-50 text-orange-700">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        60-90 minutes
    </span>
    <span class="inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium bg-yellow-50 text-brown">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
        </svg>
        Intermediate-Advanced
    </span>
    <span class="inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium bg-orange-50 text-orange-700">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>
        </svg>
        Tutorial
    </span>
</div>

<div class="bg-white border-4 border-yellow-500 p-4 mb-8">
    <div class="flex items-start gap-3">
        <svg class="w-5 h-5 text-orange-500 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
        </svg>
        <div>
            <p class="font-semibold text-charcoal mb-1">Scope</p>
            <p class="text-charcoal/80 text-sm leading-relaxed">Magento Open Source/Adobe Commerce 2.4+. This tutorial covers platform configuration and operational best practices. It is not legal advice. Consult your QSA/legal counsel for PCI DSS, GDPR/CCPA compliance requirements.</p>
        </div>
    </div>
</div>

<section class="bg-white mb-8 p-8 border-t-4 border-yellow-500 shadow-sm">
    <h2 class="text-2xl font-bold text-charcoal mb-4 mt-0">Why This Tutorial Matters</h2>
    <p class="text-lg text-gray-700 leading-relaxed mb-6">
        This tutorial gives you a proven, step-by-step process to harden your Magento store, reduce fraud/bot traffic, and align with PCI and privacy expectations - without needing deep developer skills.
    </p>
    <p class="text-gray-700 leading-relaxed mb-4">
        <strong class="text-charcoal">Business Impact:</strong> Reduce fraud and account takeover risk, avoid compliance fines, and protect revenue by hardening your store against common attacks.
    </p>
    <p class="text-gray-700 leading-relaxed">
        <strong class="text-charcoal">What You'll Achieve:</strong> A hardened Admin, bot-resistant storefront, HTTPS-only site, PCI-aligned payment setup, and a repeatable security maintenance checklist.
    </p>
</section>

<section class="mb-10">
    <h2 class="text-2xl font-bold text-charcoal mb-6">Learning Journey Overview</h2>

    <div class="bg-white border-t-4 border-orange-500 shadow-sm p-8 mb-6">
        <h3 class="text-xl font-bold text-charcoal mb-4">Your Situation</h3>
        <p class="text-gray-700 leading-relaxed">
            You manage or administer a Magento store and need a fast, reliable way to improve security, reduce PCI scope, and put continuous monitoring in place - without disrupting sales.
        </p>
    </div>

    <div class="bg-white border-t-4 border-yellow-500 shadow-sm p-8 mb-6">
        <h3 class="text-xl font-bold text-charcoal mb-4">What You'll Learn</h3>
        <p class="text-gray-700 mb-4">By completing this tutorial, you will:</p>
        <ul class="space-y-2">
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Enable and verify Admin Two-Factor Authentication (2FA)</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Configure Google reCAPTCHA for Admin and storefront forms</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Enforce HTTPS on storefront and Admin</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Harden Admin security settings (lockouts, session, password policies)</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Configure CAPTCHA for customers and password policy</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Turn on Cookie Restriction Mode and set SameSite/HTTPOnly flags</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Choose lower-PCI-scope payment methods and document your SAQ path</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Enroll your site in the Magento Security Scan and set up alerts</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Create a monthly security and compliance maintenance routine</li>
        </ul>
    </div>

    <div class="bg-white border-t-4 border-charcoal shadow-sm p-8 mb-6">
        <h3 class="text-xl font-bold text-charcoal mb-4">Success Criteria</h3>
        <p class="text-gray-700 mb-4">You'll know you've succeeded when:</p>
        <ul class="space-y-2">
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Admin login requires 2FA for all users</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">reCAPTCHA challenges appear on Admin login and customer forms as configured</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Storefront and Admin load only over HTTPS; no mixed content errors</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Security Scan shows no critical issues</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Selected payment method does not collect card data on your servers (scope reduced to SAQ A or A-EP per provider)</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Admin lockout and password policies are enforced and tested</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Cookie consent displays and SameSite/HTTPOnly settings verified</li>
        </ul>
    </div>

    <div class="bg-white border-4 border-yellow-500 p-6 mb-6">
        <div class="flex gap-4 items-start">
            <div class="flex-shrink-0 w-8 h-8">
                <svg class="w-full h-full text-orange-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M12 6v6l4 2"></path>
                </svg>
            </div>
            <div class="flex-1">
                <p class="font-bold text-charcoal mb-3">Time Investment</p>
                <ul class="space-y-2 text-gray-700">
                    <li><strong>Estimated time:</strong> 60-90 minutes</li>
                    <li><strong>Skill level after completion:</strong> Confident Intermediate-Advanced security admin for Magento</li>
                    <li><strong>Business value unlock:</strong> In ~60-90 minutes, you reduce PCI scope, block common attack paths, and implement continuous scanning - protecting revenue and lowering compliance effort.</li>
                </ul>
            </div>
        </div>
    </div>
</section>

<section class="mb-10">
    <h2 class="text-2xl font-bold text-charcoal mb-6">Before We Start</h2>

    <div class="mb-6">
        <h3 class="text-xl font-bold text-charcoal mb-4">Who This Is For</h3>
        <p class="text-gray-700 mb-4">This tutorial is designed for:</p>
        <ul class="space-y-2">
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Store owners and operations managers responsible for security</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Technical admins with Magento Admin access (Intermediate-Advanced)</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Merchants preparing for PCI DSS self-assessment (SAQ A/A-EP)</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Required experience: Comfortable navigating Magento Admin and changing configuration; developer or hosting support recommended for firewall/CDN tasks</li>
        </ul>
    </div>

    <div class="mb-6">
        <h3 class="text-xl font-bold text-charcoal mb-4">What You Need</h3>
        <p class="text-gray-700 mb-4">Make sure you have:</p>

        <div class="grid md:grid-cols-2 gap-4 mb-6">
            <div class="relative bg-gradient-to-br from-orange-50 to-white border border-orange-500/30 p-5 transition-all hover:shadow-md">
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 w-10 h-10 bg-orange-500 flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                        </svg>
                    </div>
                    <div class="flex-1">
                        <h4 class="font-semibold text-charcoal mb-1">Magento 2.4.x</h4>
                        <p class="text-sm text-charcoal/70">Open Source or Adobe Commerce</p>
                    </div>
                </div>
            </div>

            <div class="relative bg-gradient-to-br from-yellow-50 to-white border border-yellow-500/30 p-5 transition-all hover:shadow-md">
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 w-10 h-10 bg-yellow-500 flex items-center justify-center">
                        <svg class="w-5 h-5 text-charcoal" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/>
                        </svg>
                    </div>
                    <div class="flex-1">
                        <h4 class="font-semibold text-charcoal mb-1">Admin Access</h4>
                        <p class="text-sm text-charcoal/70">Magento Admin account with full permissions</p>
                    </div>
                </div>
            </div>

            <div class="relative bg-gradient-to-br from-orange-50 to-white border border-orange-500/30 p-5 transition-all hover:shadow-md">
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 w-10 h-10 bg-orange-500 flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                        </svg>
                    </div>
                    <div class="flex-1">
                        <h4 class="font-semibold text-charcoal mb-1">Google reCAPTCHA Keys</h4>
                        <p class="text-sm text-charcoal/70">Site and Secret keys (v2 Checkbox and/or v3 Invisible)</p>
                    </div>
                </div>
            </div>

            <div class="relative bg-gradient-to-br from-yellow-50 to-white border border-yellow-500/30 p-5 transition-all hover:shadow-md">
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 w-10 h-10 bg-yellow-500 flex items-center justify-center">
                        <svg class="w-5 h-5 text-charcoal" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                        </svg>
                    </div>
                    <div class="flex-1">
                        <h4 class="font-semibold text-charcoal mb-1">Payment Gateway Access</h4>
                        <p class="text-sm text-charcoal/70">Access to your payment gateway account (e.g., PayPal, Braintree, Adyen)</p>
                    </div>
                </div>
            </div>

            <div class="relative bg-gradient-to-br from-orange-50 to-white border border-orange-500/30 p-5 transition-all hover:shadow-md">
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 w-10 h-10 bg-orange-500 flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/>
                        </svg>
                    </div>
                    <div class="flex-1">
                        <h4 class="font-semibold text-charcoal mb-1">CDN/WAF Access (Optional)</h4>
                        <p class="text-sm text-charcoal/70">Access to CDN/WAF or hosting panel for IP allowlisting and HTTPS/HSTS</p>
                    </div>
                </div>
            </div>

            <div class="relative bg-gradient-to-br from-yellow-50 to-white border border-yellow-500/30 p-5 transition-all hover:shadow-md">
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 w-10 h-10 bg-yellow-500 flex items-center justify-center">
                        <svg class="w-5 h-5 text-charcoal" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <div class="flex-1">
                        <h4 class="font-semibold text-charcoal mb-1">Maintenance Window</h4>
                        <p class="text-sm text-charcoal/70">A maintenance window to test login policies without impacting customers</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="bg-white border-t-4 border-yellow-500 shadow-sm p-8">
        <h3 class="text-xl font-bold text-charcoal mb-4">Preparation Checklist</h3>
        <p class="text-gray-700 mb-4">Before starting, complete these preparation steps:</p>
        <ul class="space-y-2">
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Notify your team of the maintenance window</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Ensure you have a second Admin user as a backup</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Save current configuration (screenshot key settings)</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Have reCAPTCHA keys ready</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Confirm you can access email for 2FA and admin notifications</li>
        </ul>
    </div>
</section>

<h2 class="text-3xl font-bold text-charcoal mb-8">Step-by-Step Learning Path</h2>
<p class="text-gray-700 mb-8">Follow these steps in order. Estimated time per step is included.</p>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">1</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Enforce HTTPS (5-10 min)</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <p class="mb-4"><strong>Admin path:</strong> <span class="step-code">Stores > Configuration > General > Web > Base URLs (Secure)</span></p>
        <p class="font-semibold text-charcoal mb-3">Set:</p>
        <ul class="space-y-2 mb-4">
            <li class="relative pl-8 hexagon-bullet">Use Secure URLs on Storefront = Yes</li>
            <li class="relative pl-8 hexagon-bullet">Use Secure URLs in Admin = Yes</li>
        </ul>
        <ol class="space-y-4 list-none pl-0">
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">1.</span>
                Save Config
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">2.</span>
                Clear cache: <span class="step-code">System > Cache Management > Flush Magento Cache</span>
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">3.</span>
                <strong>Verify:</strong> Visit storefront and Admin; confirm https:// and no mixed content warnings
            </li>
        </ol>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">2</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Harden Admin Security (10-15 min)</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <p class="mb-4"><strong>Admin path:</strong> <span class="step-code">Stores > Configuration > Advanced > Admin > Security</span></p>
        <p class="font-semibold text-charcoal mb-3">Set:</p>
        <ul class="space-y-2 mb-4">
            <li class="relative pl-8 hexagon-bullet">Admin Account Sharing = No</li>
            <li class="relative pl-8 hexagon-bullet">Add Secret Key to URLs = Yes</li>
            <li class="relative pl-8 hexagon-bullet">Max Login Failures to Lockout = 5 (or lower per policy)</li>
            <li class="relative pl-8 hexagon-bullet">Lockout Time (minutes) = 30</li>
            <li class="relative pl-8 hexagon-bullet">Password Lifetime (days) = 90 (optional, per policy)</li>
            <li class="relative pl-8 hexagon-bullet">Session Lifetime (seconds) = 3600 (adjust to business needs)</li>
        </ul>
        <ol class="space-y-4 list-none pl-0">
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">1.</span>
                Save Config and Flush Magento Cache
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">2.</span>
                <strong>Verify:</strong> Using a test admin, attempt multiple failed logins to confirm lockout behavior
            </li>
        </ol>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">3</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Enable and Verify 2FA for Admin (5-10 min)</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <p class="mb-4"><strong>Admin path:</strong> <span class="step-code">Stores > Configuration > Security > 2FA</span></p>
        <p class="font-semibold text-charcoal mb-3">Action:</p>
        <ul class="space-y-2 mb-4">
            <li class="relative pl-8 hexagon-bullet">Enable 2FA providers required by your policy (e.g., Google Authenticator, WebAuthn/U2F)</li>
        </ul>
        <ol class="space-y-4 list-none pl-0">
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">1.</span>
                Save Config
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">2.</span>
                Each Admin user: log out and back in to pair a device
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">3.</span>
                <strong>Verify:</strong> All Admin users are prompted for 2FA on next login
            </li>
        </ol>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">4</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Configure Google reCAPTCHA (10-15 min)</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <p class="font-semibold text-charcoal mb-3">Admin reCAPTCHA:</p>
        <p class="mb-2"><span class="step-code">Stores > Configuration > Security > Google reCAPTCHA Admin</span></p>
        <ul class="space-y-2 mb-4">
            <li class="relative pl-8 hexagon-bullet">Enable for Admin Login and Forgot Password forms</li>
            <li class="relative pl-8 hexagon-bullet">Enter Site Key and Secret Key (Admin)</li>
        </ul>

        <p class="font-semibold text-charcoal mb-3">Storefront reCAPTCHA:</p>
        <p class="mb-2"><span class="step-code">Stores > Configuration > Security > Google reCAPTCHA Storefront</span></p>
        <ul class="space-y-2 mb-4">
            <li class="relative pl-8 hexagon-bullet">Enable for Create Account, Login, Forgot Password, Contact Us, Newsletter, Checkout forms as needed</li>
            <li class="relative pl-8 hexagon-bullet">Enter Site Key and Secret Key (Storefront)</li>
            <li class="relative pl-8 hexagon-bullet">For v3 Invisible, set Minimum Score (start at 0.3-0.5 and adjust)</li>
        </ul>
        <ol class="space-y-4 list-none pl-0">
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">1.</span>
                Save Config and Flush Magento Cache
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">2.</span>
                <strong>Verify:</strong> Forms show reCAPTCHA (v2) or pass silently (v3) and block obvious bot submissions
            </li>
        </ol>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">5</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Enable CAPTCHA and Customer Password Policies (5-10 min)</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <p class="font-semibold text-charcoal mb-3">Admin CAPTCHA:</p>
        <p class="mb-2"><span class="step-code">Stores > Configuration > Advanced > Admin > CAPTCHA</span></p>
        <ul class="space-y-2 mb-4">
            <li class="relative pl-8 hexagon-bullet">Enable CAPTCHA = Yes; configure font size, attempts, timeout</li>
        </ul>

        <p class="font-semibold text-charcoal mb-3">Customer CAPTCHA:</p>
        <p class="mb-2"><span class="step-code">Stores > Configuration > Customers > Customer Configuration > CAPTCHA</span></p>
        <ul class="space-y-2 mb-4">
            <li class="relative pl-8 hexagon-bullet">Enable on Create Account, Login, Forgot Password</li>
        </ul>

        <p class="font-semibold text-charcoal mb-3">Customer Password Options:</p>
        <p class="mb-2"><span class="step-code">Stores > Configuration > Customers > Customer Configuration > Password Options</span></p>
        <ul class="space-y-2 mb-4">
            <li class="relative pl-8 hexagon-bullet">Min Password Length = 8-12; Required Character Classes = 3 (align to policy)</li>
        </ul>
        <ol class="space-y-4 list-none pl-0">
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">1.</span>
                Save Config and Flush Magento Cache
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">2.</span>
                <strong>Verify:</strong> Customer flows require CAPTCHA; password rules enforced at registration
            </li>
        </ol>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">6</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Secure Cookies and Consent (5-10 min)</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <p class="mb-4"><strong>Admin path:</strong> <span class="step-code">Stores > Configuration > General > Web > Default Cookie Settings</span></p>
        <p class="font-semibold text-charcoal mb-3">Set:</p>
        <ul class="space-y-2 mb-4">
            <li class="relative pl-8 hexagon-bullet">Use HTTP Only = Yes</li>
            <li class="relative pl-8 hexagon-bullet">Cookie SameSite = Lax (use None + Secure only if required by embedded third-party flows)</li>
            <li class="relative pl-8 hexagon-bullet">Cookie Restriction Mode = Yes (enables consent banner)</li>
        </ul>
        <ol class="space-y-4 list-none pl-0">
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">1.</span>
                Save Config and Flush Magento Cache
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">2.</span>
                <strong>Verify:</strong> New session sets HttpOnly cookies; consent notice appears for first-time visitors
            </li>
        </ol>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">7</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Reduce PCI Scope via Payment Settings (5-10 min)</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <p class="font-semibold text-charcoal mb-3">Action:</p>
        <ul class="space-y-2 mb-4">
            <li class="relative pl-8 hexagon-bullet">Choose hosted/redirect payment methods that avoid card data touching your servers (e.g., Redirect to Provider, Hosted Fields)</li>
            <li class="relative pl-8 hexagon-bullet">In each payment method's settings: <span class="step-code">Stores > Configuration > Sales > Payment Methods</span>, enable redirect/hosted options as available</li>
            <li class="relative pl-8 hexagon-bullet">Document your intended SAQ type (A or A-EP) based on provider architecture; confirm with your gateway/QSA</li>
            <li class="relative pl-8 hexagon-bullet">Hosted/redirect payment options generally reduce PCI scope (often SAQ A or A-EP), decreasing compliance workload</li>
        </ul>
        <p><strong>Verify:</strong> Checkout redirects or renders provider-hosted fields; no card data fields are native to your page</p>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">8</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Enroll in Magento Security Scan (5-10 min)</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <ol class="space-y-4 list-none pl-0">
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">1.</span>
                Go to: <a href="https://securityscan.magento.com" class="text-orange-500 hover:underline">https://securityscan.magento.com</a> and sign in
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">2.</span>
                Add your site and verify ownership (meta tag or DNS)
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">3.</span>
                Schedule weekly scans and email alerts to your team
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">4.</span>
                <strong>Verify:</strong> First scan completes and issues are reviewed/triaged
            </li>
        </ol>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">9</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Access Control Review (5-10 min)</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <p class="font-semibold text-charcoal mb-3">Admin paths:</p>
        <ul class="space-y-2 mb-4">
            <li class="relative pl-8 hexagon-bullet"><span class="step-code">System > Permissions > User Roles</span> - apply least privilege</li>
            <li class="relative pl-8 hexagon-bullet"><span class="step-code">System > Permissions > All Users</span> - remove or disable unused accounts; require 2FA for all</li>
            <li class="relative pl-8 hexagon-bullet"><span class="step-code">System > Integrations</span> - disable or delete unused integrations and tokens</li>
        </ul>
        <p><strong>Verify:</strong> No stale users; roles are minimal and documented</p>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-8">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">10</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Create a Monthly Security Routine (5 min)</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <ul class="space-y-2">
            <li class="relative pl-8 hexagon-bullet">Establish a calendar reminder: review scan results, user accounts, and apply security patches via Composer (with your developer/host)</li>
            <li class="relative pl-8 hexagon-bullet">Document owners and SLAs for responding to alerts</li>
        </ul>
    </div>
</div>

<section class="bg-white mb-8 p-8 border-t-4 border-yellow-500 shadow-sm">
    <h2 class="text-2xl font-bold text-charcoal mb-4 mt-0">Practice and Reinforcement</h2>
    <p class="text-gray-700 mb-4">Now that you've learned the core process, let's reinforce your skills:</p>
    <ul class="space-y-2">
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Review Security Scan report and remediate findings</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Rotate Admin accounts for staff who left; audit roles</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Test 2FA recovery for at least one admin</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Submit 5-10 form entries to validate reCAPTCHA performance and adjust thresholds</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Confirm HTTPS redirects and renew TLS certificates before expiry</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Check for available security patches and schedule updates</li>
    </ul>
</section>

<section class="bg-white mb-8 p-8 border-t-4 border-orange-500 shadow-sm">
    <h2 class="text-2xl font-bold text-charcoal mb-4 mt-0">What You've Accomplished</h2>
    <p class="text-gray-700 mb-4"><strong>Congratulations!</strong> You have successfully:</p>
    <ul class="space-y-2 mb-6">
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Locked down your Admin with strong policies and 2FA</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Reduced bot and spam submissions with reCAPTCHA and CAPTCHA</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Enforced HTTPS across your site</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Lowered PCI scope by using hosted/redirect payment options</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Enrolled in automated Security Scan monitoring</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Established a monthly security and compliance routine</li>
    </ul>

    <h3 class="text-xl font-bold text-charcoal mb-4">Business Impact</h3>
    <ul class="space-y-2 mb-6">
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Lower chargeback and fraud risk by blocking automated attacks</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Reduce compliance effort and audit scope by avoiding storage/processing of cardholder data</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Protect brand trust with visible security cues (HTTPS, consent)</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Minimize downtime from compromised Admin accounts through strong access controls</li>
    </ul>

    <h3 class="text-xl font-bold text-charcoal mb-4">Skills Gained</h3>
    <p class="text-gray-700 mb-4">You now have the ability to:</p>
    <ul class="space-y-2">
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Configure and enforce 2FA, lockout, session, and password policies</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Implement and tune reCAPTCHA and CAPTCHA across key forms</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Enforce HTTPS and validate secure cookie settings</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Select payment configurations that reduce PCI scope and document SAQ approach</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Monitor your storefront with Magento Security Scan and act on alerts</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Run a repeatable monthly security and compliance review</li>
    </ul>
</section>

<section class="mb-10">
    <h2 class="text-2xl font-bold text-charcoal mb-6">Next Steps in Your Journey</h2>
    <p class="text-gray-700 mb-6">Now that you've mastered this process, here's how to build on your success:</p>

    <div class="grid md:grid-cols-3 gap-4">
        <div class="bg-white border-t-4 border-yellow-500 shadow-sm p-6">
            <h3 class="text-lg font-bold text-charcoal mb-3">Immediate Actions</h3>
            <ul class="space-y-2 text-sm">
                <li class="relative pl-6 text-gray-700 hexagon-bullet">Set calendar reminders for monthly security checks</li>
                <li class="relative pl-6 text-gray-700 hexagon-bullet">Share the new login and 2FA policy with your team</li>
                <li class="relative pl-6 text-gray-700 hexagon-bullet">Assign an owner for weekly scan reviews with a 48-hour remediation SLA</li>
            </ul>
        </div>

        <div class="bg-white border-t-4 border-orange-500 shadow-sm p-6">
            <h3 class="text-lg font-bold text-charcoal mb-3">Level Up Your Skills</h3>
            <ul class="space-y-2 text-sm">
                <li class="relative pl-6 text-gray-700 hexagon-bullet">Work with your host/CDN to enable a WAF and rate limiting</li>
                <li class="relative pl-6 text-gray-700 hexagon-bullet">Implement IP allowlisting for Admin via firewall/CDN where possible</li>
            </ul>
        </div>

        <div class="bg-white border-t-4 border-charcoal shadow-sm p-6">
            <h3 class="text-lg font-bold text-charcoal mb-3">Advanced Applications</h3>
            <ul class="space-y-2 text-sm">
                <li class="relative pl-6 text-gray-700 hexagon-bullet">Establish a patch management process with staging and rollback</li>
                <li class="relative pl-6 text-gray-700 hexagon-bullet">Conduct a quarterly user access review and incident response drill</li>
            </ul>
        </div>
    </div>
</section>

<h2 class="text-3xl font-bold text-charcoal mb-6">When Things Don't Go as Expected</h2>
<p class="text-gray-700 mb-6">Even experienced merchants encounter challenges. Here's how to handle common situations:</p>

<div class="space-y-4 my-8">
    <div class="bg-white shadow-md overflow-hidden border-t-4 border-orange-500">
        <button class="w-full p-5 text-left cursor-pointer grid grid-cols-[1fr_auto] gap-4 items-center hover:bg-orange-50 transition-colors" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('svg').classList.toggle('rotate-180')">
            <div>
                <h3 class="text-xl font-bold text-charcoal mb-1">Locked out of Admin due to 2FA</h3>
                <p class="text-charcoal/60 text-sm">Cannot access Admin after enabling 2FA</p>
            </div>
            <svg class="w-8 h-8 text-charcoal/50 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
        </button>
        <div class="hidden border-t border-orange-500/30">
            <div class="p-6">
                <h4 class="font-bold text-charcoal mb-3">Solution</h4>
                <ul class="list-none p-0 space-y-2">
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-orange-500 rounded-full"></span>
                        Ask another Admin to go to <span class="step-code">System > Permissions > All Users</span>, edit your user, and click Reset 2FA
                    </li>
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-orange-500 rounded-full"></span>
                        If no other Admin exists, a developer can run: <span class="step-code">bin/magento twofactorauth:reset &lt;username&gt;</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="bg-white shadow-md overflow-hidden border-t-4 border-yellow-500">
        <button class="w-full p-5 text-left cursor-pointer grid grid-cols-[1fr_auto] gap-4 items-center hover:bg-yellow-50 transition-colors" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('svg').classList.toggle('rotate-180')">
            <div>
                <h3 class="text-xl font-bold text-charcoal mb-1">reCAPTCHA blocks valid customers</h3>
                <p class="text-charcoal/60 text-sm">Legitimate users cannot complete forms</p>
            </div>
            <svg class="w-8 h-8 text-charcoal/50 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
        </button>
        <div class="hidden border-t border-yellow-500/30">
            <div class="p-6">
                <h4 class="font-bold text-charcoal mb-3">Solution</h4>
                <ul class="list-none p-0 space-y-2">
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-yellow-500 rounded-full"></span>
                        Lower v3 score threshold (e.g., from 0.5 to 0.3) or temporarily switch to v2 Checkbox
                    </li>
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-yellow-500 rounded-full"></span>
                        Re-test and monitor
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="bg-white shadow-md overflow-hidden border-t-4 border-yellow-500">
        <button class="w-full p-5 text-left cursor-pointer grid grid-cols-[1fr_auto] gap-4 items-center hover:bg-yellow-50 transition-colors" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('svg').classList.toggle('rotate-180')">
            <div>
                <h3 class="text-xl font-bold text-charcoal mb-1">Too many Admin lockouts</h3>
                <p class="text-charcoal/60 text-sm">Staff frequently getting locked out</p>
            </div>
            <svg class="w-8 h-8 text-charcoal/50 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
        </button>
        <div class="hidden border-t border-yellow-500/30">
            <div class="p-6">
                <h4 class="font-bold text-charcoal mb-3">Solution</h4>
                <ul class="list-none p-0 space-y-2">
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-yellow-500 rounded-full"></span>
                        Increase Max Login Failures slightly or extend Lockout Time
                    </li>
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-yellow-500 rounded-full"></span>
                        Educate staff on password managers
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="bg-white shadow-md overflow-hidden border-t-4 border-charcoal">
        <button class="w-full p-5 text-left cursor-pointer grid grid-cols-[1fr_auto] gap-4 items-center hover:bg-off-white transition-colors" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('svg').classList.toggle('rotate-180')">
            <div>
                <h3 class="text-xl font-bold text-charcoal mb-1">Checkout issues after enabling HTTPS</h3>
                <p class="text-charcoal/60 text-sm">Mixed content or redirect problems</p>
            </div>
            <svg class="w-8 h-8 text-charcoal/50 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
        </button>
        <div class="hidden border-t border-charcoal/20">
            <div class="p-6">
                <h4 class="font-bold text-charcoal mb-3">Solution</h4>
                <ul class="list-none p-0 space-y-2">
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-charcoal rounded-full"></span>
                        Clear caches/CDN
                    </li>
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-charcoal rounded-full"></span>
                        Ensure base URLs are https in <span class="step-code">Stores > Configuration > General > Web</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="bg-white shadow-md overflow-hidden border-t-4 border-charcoal">
        <button class="w-full p-5 text-left cursor-pointer grid grid-cols-[1fr_auto] gap-4 items-center hover:bg-off-white transition-colors" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('svg').classList.toggle('rotate-180')">
            <div>
                <h3 class="text-xl font-bold text-charcoal mb-1">Cookie consent not showing</h3>
                <p class="text-charcoal/60 text-sm">Banner doesn't appear for new visitors</p>
            </div>
            <svg class="w-8 h-8 text-charcoal/50 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
        </button>
        <div class="hidden border-t border-charcoal/20">
            <div class="p-6">
                <h4 class="font-bold text-charcoal mb-3">Solution</h4>
                <ul class="list-none p-0 space-y-2">
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-charcoal rounded-full"></span>
                        Confirm Cookie Restriction Mode = Yes
                    </li>
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-charcoal rounded-full"></span>
                        Clear cache
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<section class="mb-10">
    <h2 class="text-2xl font-bold text-charcoal mb-6">Continue Learning</h2>

    <div class="grid md:grid-cols-2 gap-6">
        <div class="bg-white border-t-4 border-yellow-500 shadow-sm p-6">
            <h3 class="text-lg font-bold text-charcoal mb-4">Related Tutorials</h3>
            <ul class="space-y-2">
                <li class="relative pl-8 text-gray-700 hexagon-bullet">Configure Google reCAPTCHA in Magento</li>
                <li class="relative pl-8 text-gray-700 hexagon-bullet">Setting up Two-Factor Authentication (2FA)</li>
            </ul>
        </div>

        <div class="bg-white border-t-4 border-orange-500 shadow-sm p-6">
            <h3 class="text-lg font-bold text-charcoal mb-4">How-To Guides</h3>
            <ul class="space-y-2">
                <li class="relative pl-8 text-gray-700 hexagon-bullet">Harden Admin Security Settings</li>
                <li class="relative pl-8 text-gray-700 hexagon-bullet">Reduce PCI Scope with Hosted Payments</li>
            </ul>
        </div>
    </div>
</section>

<section class="bg-white mb-8 p-8 border-t-4 border-charcoal shadow-sm">
    <h2 class="text-2xl font-bold text-charcoal mb-4 mt-0">Summary</h2>

    <h3 class="text-lg font-bold text-charcoal mb-4">Key Takeaways</h3>
    <ul class="space-y-2 mb-6">
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Admin hardened with 2FA, lockouts, and least-privilege roles</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Storefront protected by reCAPTCHA/CAPTCHA and secure cookies</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">HTTPS enforced across Admin and storefront</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">PCI scope reduced via hosted/redirect payment options</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Ongoing monitoring set up with Magento Security Scan and monthly reviews</li>
    </ul>

    <h3 class="text-lg font-bold text-charcoal mb-4">Remember</h3>
    <ul class="space-y-2">
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Small configuration changes can materially reduce fraud and compliance burden</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Revisit your settings quarterly or after major updates to stay aligned with policy and risk</li>
    </ul>
</section>

<style>
/* Hexagon bullet marker for lists */
.hexagon-bullet::before {
    content: "";
    position: absolute;
    left: 0;
    top: 0.5em;
    width: 9px;
    height: 9px;
    background-image: url("data:image/svg+xml,%3Csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12 2L21 7V17L12 22L3 17V7L12 2Z' stroke='%23F26423' stroke-width='2.5' stroke-linejoin='miter'/%3E%3C/svg%3E");
    background-size: contain;
    background-repeat: no-repeat;
}

/* Step code styling for inline code paths */
.step-code {
    background: #2C2C2C;
    color: #F1BC1B;
    padding: 0.25rem 0.5rem;
    font-family: 'Courier New', monospace;
    font-size: 0.875rem;
}
</style>
