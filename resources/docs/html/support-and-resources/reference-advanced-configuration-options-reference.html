
<h1 class="text-4xl font-bold text-charcoal mb-6">Advanced Configuration Options Reference</h1>

<div class="flex flex-wrap items-center gap-3 mb-8">
    <span class="inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium bg-orange-50 text-orange-700">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
        </svg>
        Reference
    </span>
    <span class="inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium bg-yellow-50 text-brown">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
        </svg>
        Advanced
    </span>
</div>

<!-- ============================================== -->
<!-- SECTION: Overview (Featured Boxout Style) -->
<!-- ============================================== -->
<section class="bg-white mb-8 p-8 border-t-4 border-yellow-500 shadow-sm">
    <h2 class="text-2xl font-bold text-charcoal mb-4 mt-0">Overview</h2>
    <p class="text-lg text-gray-700 leading-relaxed mb-6">
        This reference lists advanced Commerce configuration, caching, and performance settings to help merchants improve storefront speed, stability, and operating efficiency. Each entry includes where to find the setting, what it does, recommended values for production, and how to verify the impact.
    </p>
    <p class="text-gray-700 leading-relaxed mb-4">
        <strong>Applies to:</strong> Adobe Commerce and Magento Open Source 2.4.x. Settings and paths may differ in older versions.
    </p>
</section>

<!-- ============================================== -->
<!-- SECTION: Prerequisites -->
<!-- ============================================== -->
<section class="mb-10">
    <h2 class="text-2xl font-bold text-charcoal mb-6">Prerequisites</h2>
    <ul class="space-y-3">
        <li class="relative pl-8 text-gray-700 leading-relaxed hexagon-bullet">Admin access with System and Stores permissions</li>
        <li class="relative pl-8 text-gray-700 leading-relaxed hexagon-bullet">CLI access to the application server</li>
        <li class="relative pl-8 text-gray-700 leading-relaxed hexagon-bullet">Working cron configured on the server</li>
        <li class="relative pl-8 text-gray-700 leading-relaxed hexagon-bullet">For Varnish: a running Varnish service and network access</li>
        <li class="relative pl-8 text-gray-700 leading-relaxed hexagon-bullet">For Redis: Redis server available if you plan to use it for cache and/or sessions</li>
    </ul>
</section>

<!-- ============================================== -->
<!-- SECTION: Configuration -->
<!-- ============================================== -->
<h2 class="text-3xl font-bold text-charcoal mb-8">Configuration</h2>

<!-- Key Settings Reference -->
<section class="mb-10">
    <h3 class="text-2xl font-bold text-charcoal mb-6">Key Settings Reference</h3>

    <!-- 1) Cache Management -->
    <div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
        <h4 class="text-xl font-bold text-charcoal mb-4">1) Cache Management</h4>
        <p class="text-gray-700 mb-2"><strong>Path:</strong> <span class="step-code">Admin > System > Tools > Cache Management</span></p>
        <p class="text-gray-700 mb-4"><strong>What it does:</strong> Enables/disables Magento cache types and lets you refresh caches.</p>

        <p class="font-semibold text-charcoal mb-3">Recommended in production:</p>
        <p class="text-gray-700 mb-6">Keep all cache types Enabled. Never disable Page Cache (Full Page Cache) in production.</p>

        <p class="font-semibold text-charcoal mb-3">Actions:</p>
        <ul class="space-y-2 mb-6">
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Use "Flush Magento Cache" for application cache. Avoid "Flush Cache Storage" during business hours as it clears all storage and can spike origin load.</li>
        </ul>

        <p class="font-semibold text-charcoal mb-3">Verify:</p>
        <ul class="space-y-2">
            <li class="relative pl-8 text-gray-700 hexagon-bullet">CLI: <span class="step-code">bin/magento cache:status</span> — confirm all caches show 1 (enabled).</li>
        </ul>
    </div>

    <!-- 2) Full Page Cache (FPC) -->
    <div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
        <h4 class="text-xl font-bold text-charcoal mb-4">2) Full Page Cache (FPC)</h4>
        <p class="text-gray-700 mb-2"><strong>Path:</strong> <span class="step-code">Admin > Stores > Settings > Configuration > Advanced > System > Full Page Cache</span></p>

        <p class="font-semibold text-charcoal mb-3">Setting: Caching Application</p>
        <div class="bg-white shadow-sm overflow-hidden mb-6">
            <table class="w-full text-sm">
                <thead>
                    <tr class="bg-gray-100">
                        <th class="text-left px-6 py-3 font-semibold text-gray-900 border-b border-gray-200">Options</th>
                        <th class="text-left px-6 py-3 font-semibold text-gray-900 border-b border-gray-200">Details</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="hover:bg-gray-50 transition-colors">
                        <td class="px-6 py-3 text-charcoal border-b border-gray-100">Built-in Cache</td>
                        <td class="px-6 py-3 text-gray-700 border-b border-gray-100">For development only</td>
                    </tr>
                    <tr class="hover:bg-gray-50 transition-colors">
                        <td class="px-6 py-3 text-charcoal">Varnish Cache</td>
                        <td class="px-6 py-3 text-gray-700">Recommended for production</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <p class="font-semibold text-charcoal mb-3">Recommendation:</p>
        <p class="text-gray-700 mb-6">Use Varnish Cache in production for best TTFB and scalability. Use Built-in only for development or when Varnish is not available.</p>

        <p class="font-semibold text-charcoal mb-3">Additional:</p>
        <ul class="space-y-2 mb-6">
            <li class="relative pl-8 text-gray-700 hexagon-bullet"><strong>TTL for public content:</strong> Keep default unless you have a specific business need. Shorter TTL increases origin load; longer TTL improves hit rate.</li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet"><strong>Varnish configuration:</strong> After selecting Varnish Cache, use "Export VCL for Varnish" to generate the VCL for your Varnish version and deploy it to your Varnish server.</li>
        </ul>

        <div class="bg-white border-4 border-yellow-500 p-6 mb-6">
            <p class="font-bold text-charcoal mb-3">Why choose Varnish:</p>
            <ul class="space-y-2 text-gray-700">
                <li class="relative pl-8 hexagon-bullet">Offloads page rendering from PHP, reduces TTFB by up to 30-50% on cache hits, and supports higher concurrent traffic on the same hardware.</li>
                <li class="relative pl-8 hexagon-bullet"><strong>ROI:</strong> Faster pages can lift conversion and reduce infrastructure costs by improving cache hit rates.</li>
            </ul>
        </div>

        <p class="font-semibold text-charcoal mb-3">Verify:</p>
        <ul class="space-y-2">
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Check response headers for Varnish behavior (e.g., increasing <span class="step-code">Age</span> header on repeat requests) and confirm improved TTFB.</li>
        </ul>
    </div>

    <!-- 3) Index Management -->
    <div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
        <h4 class="text-xl font-bold text-charcoal mb-4">3) Index Management</h4>
        <p class="text-gray-700 mb-2"><strong>Path:</strong> <span class="step-code">Admin > System > Tools > Index Management</span></p>
        <p class="text-gray-700 mb-4"><strong>What it does:</strong> Controls how indexers update derived data.</p>

        <p class="font-semibold text-charcoal mb-3">Recommendation:</p>
        <p class="text-gray-700 mb-6">Set all indexers to "Update by Schedule" in production to reduce admin save latency. Ensure server cron runs every minute.</p>

        <div class="bg-white border-4 border-yellow-500 p-6 mb-6">
            <p class="font-bold text-charcoal mb-3">Business impact:</p>
            <ul class="space-y-2 text-gray-700">
                <li class="relative pl-8 hexagon-bullet">"Update by Schedule" keeps the storefront responsive and allows bulk admin updates without timeouts.</li>
                <li class="relative pl-8 hexagon-bullet"><strong>ROI:</strong> Reduces admin save times and errors during catalog updates; improves staff efficiency during peak merchandising cycles.</li>
            </ul>
        </div>

        <p class="font-semibold text-charcoal mb-3">Verify:</p>
        <ul class="space-y-2">
            <li class="relative pl-8 text-gray-700 hexagon-bullet">CLI: <span class="step-code">bin/magento indexer:status</span> — indexers should show "Ready" when up to date.</li>
        </ul>
    </div>

    <!-- 4) Application Mode -->
    <div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
        <h4 class="text-xl font-bold text-charcoal mb-4">4) Application Mode</h4>
        <p class="text-gray-700 mb-2"><strong>Path:</strong> CLI only</p>
        <p class="text-gray-700 mb-4"><strong>What it does:</strong> Controls runtime optimizations.</p>

        <p class="font-semibold text-charcoal mb-3">Recommendation:</p>
        <p class="text-gray-700 mb-6">Use Production mode in production environments for optimized performance and stability.</p>

        <p class="font-semibold text-charcoal mb-3">Commands:</p>
        <ul class="space-y-2 mb-6">
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Show mode: <span class="step-code">bin/magento deploy:mode:show</span></li>
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Set production: <span class="step-code">bin/magento deploy:mode:set production</span></li>
        </ul>

        <div class="bg-white border-4 border-yellow-500 p-6 mb-6">
            <p class="font-bold text-charcoal mb-3">Business impact:</p>
            <ul class="space-y-2 text-gray-700">
                <li class="relative pl-8 hexagon-bullet">Production mode compiles and serves optimized assets, decreasing page load times and reducing runtime errors.</li>
                <li class="relative pl-8 hexagon-bullet"><strong>ROI:</strong> Faster pages aid conversion and SEO; fewer errors lower support costs.</li>
            </ul>
        </div>

        <p class="font-semibold text-charcoal mb-3">Verify:</p>
        <ul class="space-y-2">
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Re-run <span class="step-code">bin/magento deploy:mode:show</span> — should read "production".</li>
        </ul>
    </div>

    <!-- 5) Cron -->
    <div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
        <h4 class="text-xl font-bold text-charcoal mb-4">5) Cron</h4>
        <p class="text-gray-700 mb-2"><strong>Path:</strong> Server crontab; optional settings at <span class="step-code">Admin > Stores > Configuration > Advanced > System > Cron</span></p>

        <p class="font-semibold text-charcoal mb-3">Recommendation:</p>
        <p class="text-gray-700 mb-6">Ensure the system cron invokes Magento every minute.</p>

        <p class="font-semibold text-charcoal mb-3">Example crontab entry:</p>
        <div class="bg-gray-900 text-yellow-400 p-4 mb-6 font-mono text-sm overflow-x-auto">
            * * * * * php /path/to/bin/magento cron:run >> var/log/magento.cron.log 2>&1
        </div>

        <p class="font-semibold text-charcoal mb-3">Verify:</p>
        <ul class="space-y-2">
            <li class="relative pl-8 text-gray-700 hexagon-bullet">Review <span class="step-code">var/log/magento.cron.log</span> for recent activity and monitor indexers/jobs completing.</li>
        </ul>
    </div>

    <!-- 6) Sessions and Cache Backends (Redis) -->
    <div class="border-t-4 border-orange-500 bg-white shadow-sm p-8">
        <h4 class="text-xl font-bold text-charcoal mb-4">6) Sessions and Cache Backends (Redis)</h4>
        <p class="text-gray-700 mb-2"><strong>Path:</strong> <span class="step-code">app/etc/env.php</span> (server configuration)</p>

        <p class="font-semibold text-charcoal mb-3">Recommendation:</p>
        <p class="text-gray-700 mb-6">Use Redis for application cache, page cache, and sessions for better performance and resilience.</p>

        <div class="bg-white border-4 border-yellow-500 p-4 mb-6">
            <div class="flex items-start gap-3">
                <svg class="w-5 h-5 text-orange-500 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                </svg>
                <div>
                    <p class="font-semibold text-charcoal mb-1">Notes</p>
                    <p class="text-charcoal/80 text-sm leading-relaxed">Configure Redis per Adobe documentation and schedule changes during a maintenance window.</p>
                </div>
            </div>
        </div>

        <p class="font-semibold text-charcoal mb-3">Verify:</p>
        <ul class="space-y-2">
            <li class="relative pl-8 text-gray-700 hexagon-bullet"><span class="step-code">bin/magento cache:status</span> and application logs; confirm Redis connections are established and error-free.</li>
        </ul>
    </div>
</section>

<!-- ============================================== -->
<!-- SECTION: Change Management and Safety -->
<!-- ============================================== -->
<section class="bg-white mb-8 p-8 border-t-4 border-yellow-500 shadow-sm">
    <h2 class="text-2xl font-bold text-charcoal mb-4 mt-0">Change Management and Safety</h2>
    <ul class="space-y-3 mb-6">
        <li class="relative pl-8 text-gray-700 leading-relaxed hexagon-bullet">Schedule changes during low-traffic windows and notify stakeholders.</li>
        <li class="relative pl-8 text-gray-700 leading-relaxed hexagon-bullet">Take a backup/snapshot before changes.</li>
    </ul>

    <p class="font-semibold text-charcoal mb-3">Rollback:</p>
    <ul class="space-y-2 mb-6">
        <li class="relative pl-8 text-gray-700 hexagon-bullet">Revert settings to prior values.</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">For Varnish, re-deploy the previous VCL.</li>
        <li class="relative pl-8 text-gray-700 hexagon-bullet">For Redis, restore the previous <span class="step-code">env.php</span> and clear generated caches.</li>
    </ul>

    <p class="font-semibold text-charcoal mb-3">Post-change verification:</p>
    <p class="text-gray-700">Check site availability, TTFB, and error logs.</p>
</section>

<!-- ============================================== -->
<!-- SECTION: Post-change Verification Checklist -->
<!-- ============================================== -->
<h2 class="text-3xl font-bold text-charcoal mb-6">Post-change verification checklist</h2>

<ul class="list-none my-8 pl-0 space-y-5">
    <!-- Checklist Item 1 -->
    <li class="bg-white p-7 shadow-sm">
        <div class="flex items-center justify-between mb-5">
            <strong class="text-lg font-bold text-charcoal">Performance Metrics</strong>
        </div>
        <ul class="grid gap-3 m-0 p-0 list-none">
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">&#10003;</span>
                Measure homepage and key product page TTFB and LCP before/after changes
            </li>
        </ul>
    </li>

    <!-- Checklist Item 2 -->
    <li class="bg-white p-7 shadow-sm">
        <div class="flex items-center justify-between mb-5">
            <strong class="text-lg font-bold text-charcoal">Cache Behavior</strong>
        </div>
        <ul class="grid gap-3 m-0 p-0 list-none">
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">&#10003;</span>
                Confirm cache hit behavior (e.g., Varnish Age header increases between requests)
            </li>
        </ul>
    </li>

    <!-- Checklist Item 3 -->
    <li class="bg-white p-7 shadow-sm">
        <div class="flex items-center justify-between mb-5">
            <strong class="text-lg font-bold text-charcoal">System Health</strong>
        </div>
        <ul class="grid gap-3 m-0 p-0 list-none">
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">&#10003;</span>
                Ensure indexers are "Ready" and cron logs show timely runs
            </li>
        </ul>
    </li>

    <!-- Checklist Item 4 -->
    <li class="bg-white p-7 shadow-sm">
        <div class="flex items-center justify-between mb-5">
            <strong class="text-lg font-bold text-charcoal">Customer Journey Testing</strong>
        </div>
        <ul class="grid gap-3 m-0 p-0 list-none">
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">&#10003;</span>
                Spot-check key customer journeys (browse, search, add to cart, checkout) for errors or slowdowns
            </li>
        </ul>
    </li>
</ul>

<style>
/* Hexagon bullet marker for lists */
.hexagon-bullet::before {
    content: "";
    position: absolute;
    left: 0;
    top: 0.5em;
    width: 9px;
    height: 9px;
    background-image: url("data:image/svg+xml,%3Csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12 2L21 7V17L12 22L3 17V7L12 2Z' stroke='%23F26423' stroke-width='2.5' stroke-linejoin='miter'/%3E%3C/svg%3E");
    background-size: contain;
    background-repeat: no-repeat;
}

/* Step code styling for inline code paths */
.step-code {
    background: #2C2C2C;
    color: #F1BC1B;
    padding: 0.25rem 0.5rem;
    font-family: 'Courier New', monospace;
    font-size: 0.875rem;
}
</style>
