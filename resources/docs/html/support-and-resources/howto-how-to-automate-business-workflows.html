
<h1 class="text-4xl font-bold text-charcoal mb-6">How to Automate Business Workflows</h1>

<div class="flex flex-wrap items-center gap-3 mb-8">
    <span class="inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium bg-orange-50 text-orange-700">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        6 minutes
    </span>
    <span class="inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium bg-yellow-50 text-brown">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
        </svg>
        Intermediate
    </span>
    <span class="inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium bg-orange-50 text-orange-700">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.99 1.99 0 013 12V7a4 4 0 014-4z"/>
        </svg>
        How-To
    </span>
</div>

<section class="bg-white mb-8 p-8 border-t-4 border-yellow-500 shadow-sm">
    <h2 class="text-2xl font-bold text-charcoal mb-4 mt-0">Overview</h2>

    <div class="bg-gray-50 border-l-4 border-yellow-500 p-6 mb-6">
        <h3 class="text-lg font-bold text-charcoal mb-3">Why Workflow Automation Matters</h3>
        <ul class="space-y-2 pl-6">
            <li class="relative hexagon-bullet pl-6 text-gray-700">Auto-invoicing accelerates pick/pack, shortening time-to-fulfill and improving cash flow</li>
            <li class="relative hexagon-bullet pl-6 text-gray-700">Auto-cancel of stale pending payments frees inventory from limbo, reducing oversell risk</li>
            <li class="relative hexagon-bullet pl-6 text-gray-700">Inventory alerts reduce out-of-stock events and lost sales opportunities</li>
            <li class="relative hexagon-bullet pl-6 text-gray-700">Strong email deliverability raises open/click rates, improving repeat purchase revenue</li>
        </ul>
    </div>

    <p class="text-lg text-gray-700 leading-relaxed mb-6">
        Automate key Magento 2 workflows to reduce manual effort, speed order processing, prevent stockouts, and deliver timely customer communications. This guide shows a growing merchant how to configure no-code automations and add a lightweight custom module for advanced tasks, improving fulfillment times and customer experience.
    </p>
    <p class="text-gray-700 leading-relaxed mb-4">
        Each automation directly impacts KPIs. Auto-invoicing accelerates pick/pack, shortening time-to-fulfill and improving cash flow. Auto-cancel of stale pending payments frees inventory from limbo, reducing oversell risk and improving conversion. Inventory alerts reduce out-of-stock events and lost sales; smart backorders can support pre-sell and cash flow. Strong email deliverability raises open/click rates, improving repeat purchase revenue and LTV.
    </p>
    <p class="text-gray-700 leading-relaxed mb-4">
        <strong>Planning time:</strong> Merchant configuration typically takes 20–40 minutes. Optional developer automations (custom module + webhook) typically take 1.5–3 hours including staging and deployment.
    </p>
    <p class="text-gray-700 leading-relaxed">
        <strong>Version compatibility:</strong> This guide applies to Magento Open Source and Adobe Commerce 2.4.x. Notes are included where behavior differs (for example, the Content Staging cron group on Adobe Commerce, Cloud-managed cron, and MSI inventory specifics).
    </p>
</section>

<section class="bg-white mb-8 p-8 border-t-4 border-yellow-500 shadow-sm">
    <h2 class="text-2xl font-bold text-charcoal mb-6 mt-0">Prerequisites</h2>
    <p class="text-gray-700 mb-6">Before you begin, make sure you have:</p>
    <div class="grid md:grid-cols-2 gap-4">
        <div class="relative bg-gradient-to-br from-orange-50 to-white border border-orange-500/30 p-5">
            <div class="flex items-start gap-4">
                <div class="w-10 h-10 bg-orange-500 flex items-center justify-center flex-shrink-0">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                    </svg>
                </div>
                <div>
                    <h4 class="font-semibold text-charcoal mb-1">Admin Panel Access</h4>
                    <p class="text-sm text-charcoal/70">Access to Magento Admin Panel with permission to Stores > Configuration</p>
                </div>
            </div>
        </div>
        <div class="relative bg-gradient-to-br from-yellow-50 to-white border border-yellow-500/30 p-5">
            <div class="flex items-start gap-4">
                <div class="w-10 h-10 bg-yellow-500 flex items-center justify-center flex-shrink-0">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                    </svg>
                </div>
                <div>
                    <h4 class="font-semibold text-charcoal mb-1">SMTP Configuration</h4>
                    <p class="text-sm text-charcoal/70">Transactional email provider credentials (host, port, username, TLS/SSL)</p>
                </div>
            </div>
        </div>
        <div class="relative bg-gradient-to-br from-orange-50 to-white border border-orange-500/30 p-5">
            <div class="flex items-start gap-4">
                <div class="w-10 h-10 bg-orange-500 flex items-center justify-center flex-shrink-0">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                    </svg>
                </div>
                <div>
                    <h4 class="font-semibold text-charcoal mb-1">Product Catalog</h4>
                    <p class="text-sm text-charcoal/70">Product catalog set up with at least one test product</p>
                </div>
            </div>
        </div>
        <div class="relative bg-gradient-to-br from-yellow-50 to-white border border-yellow-500/30 p-5">
            <div class="flex items-start gap-4">
                <div class="w-10 h-10 bg-yellow-500 flex items-center justify-center flex-shrink-0">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                    </svg>
                </div>
                <div>
                    <h4 class="font-semibold text-charcoal mb-1">Developer Prerequisites</h4>
                    <p class="text-sm text-charcoal/70">For Steps 5–6: CLI access, development environment, basic PHP knowledge</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="bg-white mb-8 p-8 border-t-4 border-yellow-500 shadow-sm">
    <h2 class="text-2xl font-bold text-charcoal mb-4 mt-0">What You'll Accomplish</h2>
    <p class="text-gray-700 mb-4">By following this guide, you will:</p>
    <ul class="space-y-3 pl-6">
        <li class="relative hexagon-bullet pl-6 text-gray-700">Automate key business workflows (emails, invoicing, inventory alerts)</li>
        <li class="relative hexagon-bullet pl-6 text-gray-700">Improve order processing speed and customer experience</li>
        <li class="relative hexagon-bullet pl-6 text-gray-700">Set up automated order cancellation for stale pending payments</li>
        <li class="relative hexagon-bullet pl-6 text-gray-700">Push order updates to external systems via webhook (optional)</li>
    </ul>
</section>

<h2 class="text-3xl font-bold text-charcoal mb-8">Step-by-Step Instructions</h2>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">0</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Enable and verify Magento cron</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <div class="bg-white border-4 border-yellow-500 p-4 mb-4 flex gap-3 items-start">
            <svg class="w-5 h-5 text-orange-500 flex-shrink-0 mt-0.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="16" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12.01" y2="8"></line>
            </svg>
            <p class="text-charcoal text-sm"><strong>Note:</strong> This step is a prerequisite for later automations.</p>
        </div>
        <ol class="space-y-4 list-none pl-0">
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">1.</span>
                In CLI, run: <code class="step-code">bin/magento cron:install</code>
                <div class="bg-yellow-500 border-4 border-amber-600 p-4 mt-3 flex gap-3 items-start">
                    <svg class="w-6 h-6 text-amber-700 flex-shrink-0" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2L1 21h22L12 2zm0 3.99L19.53 19H4.47L12 5.99zM11 16h2v2h-2v-2zm0-6h2v4h-2v-4z"/>
                    </svg>
                    <p class="text-brown"><strong>Adobe Commerce on cloud:</strong> Do not run cron:install. Cron is managed via your .magento.app.yaml. See Adobe Commerce on cloud > Configure cron.</p>
                </div>
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">2.</span>
                Verify the crontab: <code class="step-code">crontab -l</code> (should include Magento cron entries)
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">3.</span>
                Manually trigger to test:
                <pre class="bg-charcoal text-yellow-500 p-4 overflow-x-auto mt-2 text-sm font-mono">bin/magento cron:run --group=default && bin/magento cron:run --group=index</pre>
                <p class="text-gray-700 mt-2">If you use Adobe Commerce with Content Staging, also run: <code class="step-code">bin/magento cron:run --group=staging</code></p>
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">4.</span>
                Check <code class="step-code">var/log/system.log</code> and <code class="step-code">var/log/cron.log</code> for successful execution
            </li>
        </ol>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">1</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Configure transactional emails (orders, invoices, shipments)</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <ol class="space-y-4 list-none pl-0">
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">1.</span>
                Set sender identities first: Go to <span class="step-code">Stores > Configuration > General > Store Email Addresses</span> and set names/emails for General Contact and Sales Representative (and others you use)
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">2.</span>
                Ensure mail is enabled: Go to <span class="step-code">Stores > Configuration > Advanced > System > Mail Sending Settings</span> and confirm Disable Email Communications = No
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">3.</span>
                Go to <span class="step-code">Admin > Stores > Configuration > Sales > Sales Emails</span>
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">4.</span>
                Enable Order, Invoice, Shipment, and Credit Memo emails; select appropriate email templates and sender identities
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">5.</span>
                For customer emails, go to <span class="step-code">Customers > Customer Configuration > Create New Account Options</span> and set the Welcome email template; verify Forgot Password template under Password Options
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">6.</span>
                Save config and clear cache if prompted. Send test orders to verify
            </li>
        </ol>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">2</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Set payment actions to drive auto-invoicing where appropriate</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <ol class="space-y-4 list-none pl-0 mb-4">
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">1.</span>
                Go to <span class="step-code">Stores > Configuration > Sales > Payment Methods</span>
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">2.</span>
                For each online gateway that supports capture on authorization, set Payment Action to <strong>Authorize and Capture</strong>
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">3.</span>
                For offline methods (e.g., Check/Money Order), leave as Authorize or manual to keep control
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">4.</span>
                Save and test a checkout with a capture-enabled method
            </li>
        </ol>
        <div class="bg-white border-4 border-yellow-500 p-4 flex gap-3 items-start">
            <svg class="w-5 h-5 text-orange-500 flex-shrink-0 mt-0.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="16" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12.01" y2="8"></line>
            </svg>
            <p class="text-charcoal text-sm"><strong>Note:</strong> Many gateways create invoices automatically on capture, but this behavior is integration-specific. Confirm your gateway settings and test that an invoice is created and the Invoice Email is sent (Sales > Sales Emails).</p>
        </div>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">3</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Automate inventory alerts and stock behavior</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <ol class="space-y-4 list-none pl-0 mb-4">
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">1.</span>
                Go to <span class="step-code">Stores > Configuration > Catalog > Inventory</span>
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">2.</span>
                Under Stock Options and Product Stock Options, set Display Out of Stock Products (per your merchandising plan), Backorders policy, and Notify for Quantity Below (global threshold; override per product when needed)
                <div class="bg-white border-4 border-yellow-500 p-4 mt-3 flex gap-3 items-start">
                    <svg class="w-5 h-5 text-orange-500 flex-shrink-0 mt-0.5" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6A4.997 4.997 0 017 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1z"/>
                    </svg>
                    <p class="text-charcoal text-sm"><strong>Merchant tip:</strong> Displaying OOS products with an "Email me when available" option can capture demand and preserve SEO value. Allow backorders only when you have reliable lead times to avoid cancellations and refunds.</p>
                </div>
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">3.</span>
                Ensure cron is enabled so Product Alerts (stock/price) emails send. The <span class="step-code">Reports > Products > Low Stock</span> report pulls current data when you view it
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">4.</span>
                If your edition doesn't email low stock alerts, plan to add either: (a) an extension that emails the report, or (b) a small custom cron job to notify your team (see next steps)
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">5.</span>
                <strong>MSI note (2.4.x):</strong> With Multi-Source Inventory enabled, "Low Stock" evaluates Salable Quantity. Per-product thresholds can be set under <span class="step-code">Catalog > Products > [Product] > Sources</span> and Advanced Inventory. The global "Notify for Quantity Below" remains under <span class="step-code">Stores > Configuration > Catalog > Inventory > Product Stock Options</span>
            </li>
        </ol>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">4</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Harden email deliverability</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <ol class="space-y-4 list-none pl-0 mb-4">
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">1.</span>
                Configure a reliable SMTP/transactional email service using a trusted SMTP extension
                <ul class="mt-3 space-y-2 pl-6">
                    <li class="relative hexagon-bullet pl-6 text-gray-700">After installation, go to <span class="step-code">Stores > Configuration > Advanced > System > SMTP</span> (or the extension's config) and enter your provider settings (host, port, authentication, TLS/SSL)</li>
                    <li class="relative hexagon-bullet pl-6 text-gray-700">Send a test order and verify delivery in your provider dashboard</li>
                </ul>
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">2.</span>
                Set proper SPF/DKIM/DMARC for your sender domain to improve inbox placement
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">3.</span>
                Monitor impact: Track bounce rate and open/click rates for transactional emails. Improving deliverability increases reach and can lift repeat purchase revenue and LTV
            </li>
        </ol>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">5</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Create a custom module: auto-cancel stale Pending Payment orders</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <p class="text-gray-700 leading-relaxed mb-4">In your development environment:</p>

        <h4 class="font-semibold text-charcoal mb-3 text-lg">1. Create module skeleton: <code class="step-code">app/code/Vendor/AutoCancel/</code></h4>

        <div class="mb-6">
            <p class="font-medium text-charcoal mb-2">registration.php:</p>
            <pre class="bg-charcoal text-yellow-500 p-4 overflow-x-auto text-sm font-mono">&lt;?php
use Magento\Framework\Component\ComponentRegistrar;
ComponentRegistrar::register(ComponentRegistrar::MODULE, 'Vendor_AutoCancel', __DIR__);</pre>
        </div>

        <div class="mb-6">
            <p class="font-medium text-charcoal mb-2">etc/module.xml:</p>
            <pre class="bg-charcoal text-yellow-500 p-4 overflow-x-auto text-sm font-mono">&lt;?xml version="1.0"?&gt;
&lt;config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:framework:Module/etc/module.xsd"&gt;
    &lt;module name="Vendor_AutoCancel" setup_version="1.0.0"/&gt;
&lt;/config&gt;</pre>
        </div>

        <div class="mb-6">
            <p class="font-medium text-charcoal mb-2">etc/crontab.xml:</p>
            <pre class="bg-charcoal text-yellow-500 p-4 overflow-x-auto text-sm font-mono">&lt;?xml version="1.0"?&gt;
&lt;config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:framework:config/etc/crontab.xsd"&gt;
    &lt;group id="default"&gt;
        &lt;job name="vendor_autocancel_pending" instance="Vendor\AutoCancel\Cron\CancelPending"
             method="execute" schedule="*/10 * * * *"/&gt;
    &lt;/group&gt;
&lt;/config&gt;</pre>
        </div>

        <div class="mb-6">
            <p class="font-medium text-charcoal mb-2">etc/adminhtml/system.xml (adds a configurable hours threshold):</p>
            <pre class="bg-charcoal text-yellow-500 p-4 overflow-x-auto text-sm font-mono">&lt;?xml version="1.0"?&gt;
&lt;config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Config:etc/system_file.xsd"&gt;
    &lt;system&gt;
        &lt;section id="vendor_autocancel" translate="label" sortOrder="900" showInDefault="1"
                 showInWebsite="1" showInStore="1"&gt;
            &lt;label&gt;Auto Cancel Settings&lt;/label&gt;
            &lt;tab&gt;sales&lt;/tab&gt;
            &lt;resource&gt;Vendor_AutoCancel::config&lt;/resource&gt;
            &lt;group id="general" translate="label" sortOrder="10" showInDefault="1"
                   showInWebsite="1" showInStore="1"&gt;
                &lt;label&gt;General&lt;/label&gt;
                &lt;field id="hours" translate="label" type="text" sortOrder="10"
                       showInDefault="1" showInWebsite="1" showInStore="1"&gt;
                    &lt;label&gt;Cancel after (hours)&lt;/label&gt;
                    &lt;comment&gt;Orders in pending_payment state older than this will be canceled by cron.&lt;/comment&gt;
                    &lt;validate&gt;validate-number validate-greater-than-zero&lt;/validate&gt;
                    &lt;config_path&gt;vendor_autocancel/general/hours&lt;/config_path&gt;
                &lt;/field&gt;
            &lt;/group&gt;
        &lt;/section&gt;
    &lt;/system&gt;
&lt;/config&gt;</pre>
        </div>

        <div class="mb-6">
            <p class="font-medium text-charcoal mb-2">Cron/CancelPending.php (uses service contracts, state filter, and logging):</p>
            <pre class="bg-charcoal text-yellow-500 p-4 overflow-x-auto text-sm font-mono">&lt;?php
namespace Vendor\AutoCancel\Cron;

use Magento\Sales\Model\Order;
use Magento\Sales\Model\ResourceModel\Order\CollectionFactory as OrderCollectionFactory;
use Magento\Sales\Api\OrderRepositoryInterface;
use Magento\Framework\Stdlib\DateTime\DateTime;
use Magento\Framework\App\Config\ScopeConfigInterface;
use Magento\Store\Model\ScopeInterface;
use Psr\Log\LoggerInterface;

class CancelPending
{
    private OrderCollectionFactory $orders;
    private OrderRepositoryInterface $orderRepository;
    private DateTime $date;
    private ScopeConfigInterface $scopeConfig;
    private LoggerInterface $logger;

    public function __construct(
        OrderCollectionFactory $orders,
        OrderRepositoryInterface $orderRepository,
        DateTime $date,
        ScopeConfigInterface $scopeConfig,
        LoggerInterface $logger
    ) {
        $this->orders = $orders;
        $this->orderRepository = $orderRepository;
        $this->date = $date;
        $this->scopeConfig = $scopeConfig;
        $this->logger = $logger;
    }

    public function execute(): bool
    {
        try {
            $hours = (int)($this->scopeConfig->getValue(
                'vendor_autocancel/general/hours',
                ScopeInterface::SCOPE_STORE
            ) ?? 48);
            if ($hours &lt;= 0) {
                $hours = 48;
            }
            $cutoffTs = strtotime("-{$hours} hours", $this->date->gmtTimestamp());
            $cutoff = gmdate('Y-m-d H:i:s', $cutoffTs);

            $collection = $this->orders->create()
                ->addFieldToFilter('state', Order::STATE_PENDING_PAYMENT)
                ->addFieldToFilter('created_at', ['lt' => $cutoff]);

            foreach ($collection as $order) {
                try {
                    if ($order->canCancel()) {
                        $order->cancel();
                        $order->addCommentToStatusHistory('Auto-canceled after timeout.');
                        $this->orderRepository->save($order);
                    }
                } catch (\Throwable $e) {
                    $this->logger->error('Auto-cancel failed', [
                        'order_id' => $order->getId(),
                        'message' => $e->getMessage(),
                    ]);
                }
            }
        } catch (\Throwable $e) {
            $this->logger->error('Auto-cancel cron error: ' . $e->getMessage());
        }
        return true;
    }
}</pre>
        </div>

        <h4 class="font-semibold text-charcoal mb-3 text-lg">2. Enable and deploy</h4>
        <pre class="bg-charcoal text-yellow-500 p-4 overflow-x-auto mb-4 text-sm font-mono">bin/magento module:enable Vendor_AutoCancel && bin/magento setup:upgrade && bin/magento cache:flush</pre>
        <p class="text-gray-700 mb-4">If in production mode, also run: <code class="step-code">bin/magento setup:di:compile</code></p>

        <h4 class="font-semibold text-charcoal mb-3 text-lg">3. Verify cron runs and observe orders transitioning to Canceled after the threshold (test in staging)</h4>

        <div class="bg-gray-50 p-4 mt-4">
            <p class="font-semibold text-charcoal mb-2">Timeout guidance by payment method:</p>
            <p class="text-sm text-gray-700 mb-3">Choose a value that balances revenue protection with inventory availability:</p>
            <ul class="space-y-2 pl-6">
                <li class="relative hexagon-bullet pl-6 text-gray-700"><strong>Card/real-time gateways</strong> (Auth+Capture at checkout): 24–48 hours</li>
                <li class="relative hexagon-bullet pl-6 text-gray-700"><strong>PayPal pending eCheck</strong> or similar delayed capture: 48–72 hours</li>
                <li class="relative hexagon-bullet pl-6 text-gray-700"><strong>Bank transfer/offline methods:</strong> 5–7 days (or cancel manually)</li>
            </ul>
        </div>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">6</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Optional: push order updates to external systems via webhook</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <h4 class="font-semibold text-charcoal mb-3 text-lg">1. Add etc/events.xml in your module</h4>
        <pre class="bg-charcoal text-yellow-500 p-4 overflow-x-auto mb-4 text-sm font-mono">&lt;?xml version="1.0"?&gt;
&lt;config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:framework:Event/etc/events.xsd"&gt;
    &lt;event name="sales_order_save_after"&gt;
        &lt;observer name="vendor_order_webhook" instance="Vendor\AutoCancel\Observer\OrderWebhook"/&gt;
    &lt;/event&gt;
&lt;/config&gt;</pre>

        <h4 class="font-semibold text-charcoal mb-3 text-lg">2. Add admin configuration for the webhook (extend etc/adminhtml/system.xml)</h4>
        <pre class="bg-charcoal text-yellow-500 p-4 overflow-x-auto mb-4 text-sm font-mono">&lt;?xml version="1.0"?&gt;
&lt;config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Config:etc/system_file.xsd"&gt;
    &lt;system&gt;
        &lt;section id="vendor_autocancel"&gt;
            &lt;group id="webhook" translate="label" sortOrder="20" showInDefault="1"
                   showInWebsite="1" showInStore="1"&gt;
                &lt;label&gt;Webhook&lt;/label&gt;
                &lt;field id="endpoint" translate="label" type="text" sortOrder="10"
                       showInDefault="1" showInWebsite="1" showInStore="1"&gt;
                    &lt;label&gt;Endpoint URL&lt;/label&gt;
                    &lt;config_path&gt;vendor_autocancel/webhook/endpoint&lt;/config_path&gt;
                &lt;/field&gt;
                &lt;field id="secret" translate="label" type="obscure" sortOrder="20"
                       showInDefault="1" showInWebsite="1" showInStore="1"&gt;
                    &lt;label&gt;Shared Secret&lt;/label&gt;
                    &lt;config_path&gt;vendor_autocancel/webhook/secret&lt;/config_path&gt;
                &lt;/field&gt;
                &lt;field id="timeout" translate="label" type="text" sortOrder="30"
                       showInDefault="1" showInWebsite="1" showInStore="1"&gt;
                    &lt;label&gt;Timeout (seconds)&lt;/label&gt;
                    &lt;config_path&gt;vendor_autocancel/webhook/timeout&lt;/config_path&gt;
                    &lt;validate&gt;validate-number validate-greater-than-zero&lt;/validate&gt;
                &lt;/field&gt;
            &lt;/group&gt;
        &lt;/section&gt;
    &lt;/system&gt;
&lt;/config&gt;</pre>

        <h4 class="font-semibold text-charcoal mb-3 text-lg">3. Create Observer/OrderWebhook.php that posts JSON to your automation platform</h4>
        <p class="text-sm text-gray-700 mb-3">With status-change guard, timeout, and HMAC signature:</p>
        <pre class="bg-charcoal text-yellow-500 p-4 overflow-x-auto mb-4 text-sm font-mono">&lt;?php
namespace Vendor\AutoCancel\Observer;

use Magento\Framework\Event\Observer;
use Magento\Framework\Event\ObserverInterface;
use Magento\Framework\HTTP\Client\Curl;
use Magento\Framework\App\Config\ScopeConfigInterface;
use Magento\Store\Model\ScopeInterface;
use Psr\Log\LoggerInterface;

class OrderWebhook implements ObserverInterface
{
    private Curl $curl;
    private ScopeConfigInterface $scopeConfig;
    private LoggerInterface $logger;

    public function __construct(Curl $curl, ScopeConfigInterface $scopeConfig, LoggerInterface $logger)
    {
        $this->curl = $curl;
        $this->scopeConfig = $scopeConfig;
        $this->logger = $logger;
    }

    public function execute(Observer $observer)
    {
        $order = $observer->getEvent()->getOrder();

        // Avoid duplicate calls: only act when status changes to complete
        if (!$order->dataHasChangedFor('status') || $order->getStatus() !== 'complete') {
            return;
        }

        $endpoint = (string)($this->scopeConfig->getValue(
            'vendor_autocancel/webhook/endpoint',
            ScopeInterface::SCOPE_STORE
        ) ?? '');
        $secret = (string)($this->scopeConfig->getValue(
            'vendor_autocancel/webhook/secret',
            ScopeInterface::SCOPE_STORE
        ) ?? '');
        $timeout = (int)($this->scopeConfig->getValue(
            'vendor_autocancel/webhook/timeout',
            ScopeInterface::SCOPE_STORE
        ) ?? 5);
        if (!$endpoint) {
            return;
        }

        $payload = json_encode([
            'increment_id' => $order->getIncrementId(),
            'grand_total' => $order->getGrandTotal(),
            'customer_email' => $order->getCustomerEmail(),
            'status' => $order->getStatus(),
        ]);

        try {
            $this->curl->addHeader('Content-Type', 'application/json');
            if ($secret !== '') {
                $sig = hash_hmac('sha256', (string)$payload, $secret);
                $this->curl->addHeader('X-Signature', $sig);
            }
            $this->curl->setTimeout($timeout > 0 ? $timeout : 5);
            $this->curl->post($endpoint, (string)$payload);

            $status = (int)$this->curl->getStatus();
            if ($status &lt; 200 || $status >= 300) {
                $this->logger->error('Order webhook non-2xx response', [
                    'order_id' => $order->getId(),
                    'status' => $status,
                    'body' => $this->curl->getBody(),
                ]);
            }
        } catch (\Throwable $e) {
            $this->logger->error('Order webhook error: ' . $e->getMessage(), [
                'order_id' => $order->getId(),
            ]);
        }
    }
}</pre>

        <h4 class="font-semibold text-charcoal mb-3 text-lg">4. Verification</h4>
        <p class="text-gray-700">Deploy, then complete an order; confirm the external system receives a single POST with the expected JSON and signature.</p>
    </div>
</div>

<div class="border-t-4 border-yellow-500 bg-white shadow-sm p-8 mb-6">
    <div class="flex items-center gap-4 mb-6">
        <div class="w-10 h-10 bg-yellow-500 text-charcoal font-extrabold text-lg flex items-center justify-center flex-shrink-0">7</div>
        <h3 class="text-2xl font-bold text-charcoal m-0">Deploy, test, and measure impact</h3>
    </div>
    <div class="text-gray-700 leading-relaxed">
        <ol class="space-y-4 list-none pl-0 mb-4">
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">1.</span>
                Deploy to staging; run functional tests (place test orders, simulate low stock)
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">2.</span>
                Deploy to production during low traffic; monitor logs and email deliverability for 24–48 hours
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">3.</span>
                Track KPIs: average time-to-fulfill, cancellation rate, low-stock incidents, email delivery rate and open rate. Iterate thresholds and schedules as needed
            </li>
            <li class="relative pl-10">
                <span class="absolute left-0 top-0 font-semibold text-charcoal">4.</span>
                <strong>Rollback plan:</strong> If issues arise, disable the custom module (<code class="step-code">bin/magento module:disable Vendor_AutoCancel && bin/magento setup:upgrade</code>), revert code via VCS, revert configuration changes under Stores > Configuration, clear cache, and retest
            </li>
        </ol>
    </div>
</div>

<h2 class="text-3xl font-bold text-charcoal mb-6">Verification</h2>
<p class="text-gray-700 mb-6">To confirm everything is working correctly:</p>

<ul class="list-none my-8 pl-0 space-y-5">
    <li class="bg-white p-7 shadow-sm">
        <div class="flex items-center justify-between mb-5">
            <strong class="text-lg font-bold text-charcoal">Sales Emails</strong>
        </div>
        <ul class="grid gap-3 m-0 p-0 list-none">
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">✓</span>
                Place a test order; confirm Order, Invoice, and Shipment emails are received
            </li>
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">✓</span>
                If using custom templates, check Marketing > Email Templates for correct assignment
            </li>
        </ul>
    </li>

    <li class="bg-white p-7 shadow-sm">
        <div class="flex items-center justify-between mb-5">
            <strong class="text-lg font-bold text-charcoal">Auto-Invoicing</strong>
        </div>
        <ul class="grid gap-3 m-0 p-0 list-none">
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">✓</span>
                Place an order with a capture-enabled payment method
            </li>
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">✓</span>
                Under Sales > Orders > View > Invoices, confirm invoice was created and Invoice Email was sent
            </li>
        </ul>
    </li>

    <li class="bg-white p-7 shadow-sm">
        <div class="flex items-center justify-between mb-5">
            <strong class="text-lg font-bold text-charcoal">Inventory Alerts</strong>
        </div>
        <ul class="grid gap-3 m-0 p-0 list-none">
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">✓</span>
                Lower a product's salable quantity below your threshold
            </li>
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">✓</span>
                Check Reports > Products > Low Stock shows the product
            </li>
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">✓</span>
                If using product alerts, subscribe to stock/price alerts and confirm email received when triggered by cron
            </li>
        </ul>
    </li>

    <li class="bg-white p-7 shadow-sm">
        <div class="flex items-center justify-between mb-5">
            <strong class="text-lg font-bold text-charcoal">Auto-Cancel</strong>
        </div>
        <ul class="grid gap-3 m-0 p-0 list-none">
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">✓</span>
                In staging, create a Pending Payment order
            </li>
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">✓</span>
                Temporarily set cancel threshold to 0.05 hours (~3 minutes)
            </li>
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">✓</span>
                Confirm it moves to Canceled with history comment "Auto-canceled after timeout."
            </li>
        </ul>
    </li>

    <li class="bg-white p-7 shadow-sm">
        <div class="flex items-center justify-between mb-5">
            <strong class="text-lg font-bold text-charcoal">Webhook Integration</strong>
        </div>
        <ul class="grid gap-3 m-0 p-0 list-none">
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">✓</span>
                Complete an order; confirm endpoint receives single POST with expected JSON
            </li>
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">✓</span>
                Verify X-Signature header is present and valid
            </li>
            <li class="flex items-start gap-3 p-3 pl-10 bg-gray-50 hover:bg-orange-50 transition-colors relative">
                <span class="absolute left-3 top-3 w-5 h-5 border-2 border-yellow-500 flex items-center justify-center text-yellow-500 font-bold text-sm">✓</span>
                Ensure no duplicate calls occur on subsequent order edits
            </li>
        </ul>
    </li>
</ul>

<h2 class="text-3xl font-bold text-charcoal mb-6">Common Issues and Solutions</h2>

<div class="space-y-4 my-8">
    <div class="bg-white shadow-md overflow-hidden border-t-4 border-orange-500">
        <button class="w-full p-5 text-left cursor-pointer grid grid-cols-[1fr_auto] gap-4 items-center hover:bg-orange-50 transition-colors" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('svg').classList.toggle('rotate-180')">
            <div>
                <h3 class="text-xl font-bold text-charcoal mb-1">Emails not sending</h3>
                <p class="text-charcoal/60 text-sm">Transactional emails are not being delivered to customers</p>
            </div>
            <svg class="w-8 h-8 text-charcoal/50 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
        </button>
        <div class="hidden border-t border-orange-500/30">
            <div class="p-6">
                <h4 class="font-bold text-charcoal mb-3">Solution</h4>
                <ul class="list-none p-0 space-y-2">
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-orange-500 rounded-full"></span>
                        Check Stores > Configuration > Advanced > System > Mail Sending Settings (Disable Email Communications = No)
                    </li>
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-orange-500 rounded-full"></span>
                        Verify SMTP provider credentials in your SMTP extension settings
                    </li>
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-orange-500 rounded-full"></span>
                        Review var/log/exception.log for mail errors and your provider dashboard for bounces
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="bg-white shadow-md overflow-hidden border-t-4 border-yellow-500">
        <button class="w-full p-5 text-left cursor-pointer grid grid-cols-[1fr_auto] gap-4 items-center hover:bg-yellow-50 transition-colors" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('svg').classList.toggle('rotate-180')">
            <div>
                <h3 class="text-xl font-bold text-charcoal mb-1">Cron not running</h3>
                <p class="text-charcoal/60 text-sm">Scheduled automation tasks are not executing</p>
            </div>
            <svg class="w-8 h-8 text-charcoal/50 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
        </button>
        <div class="hidden border-t border-yellow-500/30">
            <div class="p-6">
                <h4 class="font-bold text-charcoal mb-3">Solution</h4>
                <ul class="list-none p-0 space-y-2">
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-yellow-500 rounded-full"></span>
                        Ensure the system crontab includes Magento entries (crontab -l) and uses correct PHP binary path
                    </li>
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-yellow-500 rounded-full"></span>
                        Review var/log/cron.log for errors
                    </li>
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-yellow-500 rounded-full"></span>
                        On Adobe Commerce on cloud, manage cron via .magento.app.yaml
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="bg-white shadow-md overflow-hidden border-t-4 border-yellow-500">
        <button class="w-full p-5 text-left cursor-pointer grid grid-cols-[1fr_auto] gap-4 items-center hover:bg-yellow-50 transition-colors" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('svg').classList.toggle('rotate-180')">
            <div>
                <h3 class="text-xl font-bold text-charcoal mb-1">Orders not auto-invoicing</h3>
                <p class="text-charcoal/60 text-sm">Payment captured but invoice not automatically created</p>
            </div>
            <svg class="w-8 h-8 text-charcoal/50 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
        </button>
        <div class="hidden border-t border-yellow-500/30">
            <div class="p-6">
                <h4 class="font-bold text-charcoal mb-3">Solution</h4>
                <ul class="list-none p-0 space-y-2">
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-yellow-500 rounded-full"></span>
                        Confirm the payment method supports automatic capture
                    </li>
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-yellow-500 rounded-full"></span>
                        Verify gateway is configured to create invoices on capture
                    </li>
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-yellow-500 rounded-full"></span>
                        Test and verify Invoice Email is sent (Sales > Sales Emails)
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="bg-white shadow-md overflow-hidden border-t-4 border-charcoal">
        <button class="w-full p-5 text-left cursor-pointer grid grid-cols-[1fr_auto] gap-4 items-center hover:bg-off-white transition-colors" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('svg').classList.toggle('rotate-180')">
            <div>
                <h3 class="text-xl font-bold text-charcoal mb-1">Auto-cancel not working</h3>
                <p class="text-charcoal/60 text-sm">Pending payment orders not being automatically canceled after timeout</p>
            </div>
            <svg class="w-8 h-8 text-charcoal/50 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
        </button>
        <div class="hidden border-t border-charcoal/20">
            <div class="p-6">
                <h4 class="font-bold text-charcoal mb-3">Solution</h4>
                <ul class="list-none p-0 space-y-2">
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-charcoal rounded-full"></span>
                        Verify the cron schedule in etc/crontab.xml and that your cron is running
                    </li>
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-charcoal rounded-full"></span>
                        Ensure the collection filter uses state = pending_payment
                    </li>
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-charcoal rounded-full"></span>
                        Confirm threshold hours are set > 0 in configuration
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="bg-white shadow-md overflow-hidden border-t-4 border-charcoal">
        <button class="w-full p-5 text-left cursor-pointer grid grid-cols-[1fr_auto] gap-4 items-center hover:bg-off-white transition-colors" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('svg').classList.toggle('rotate-180')">
            <div>
                <h3 class="text-xl font-bold text-charcoal mb-1">Duplicate webhooks</h3>
                <p class="text-charcoal/60 text-sm">External system receiving multiple webhook calls for single order update</p>
            </div>
            <svg class="w-8 h-8 text-charcoal/50 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
        </button>
        <div class="hidden border-t border-charcoal/20">
            <div class="p-6">
                <h4 class="font-bold text-charcoal mb-3">Solution</h4>
                <ul class="list-none p-0 space-y-2">
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-charcoal rounded-full"></span>
                        Ensure the observer checks dataHasChangedFor('status')
                    </li>
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-charcoal rounded-full"></span>
                        Only fire on the intended status transition (e.g., to complete)
                    </li>
                    <li class="relative pl-7 py-1 text-charcoal">
                        <span class="absolute left-1.5 top-3.5 w-2 h-2 bg-charcoal rounded-full"></span>
                        Consider idempotency keys on the receiving system
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<style>
/* Hexagon bullet marker for lists */
.hexagon-bullet::before {
    content: "";
    position: absolute;
    left: 0;
    top: 0.5em;
    width: 9px;
    height: 9px;
    background-image: url("data:image/svg+xml,%3Csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12 2L21 7V17L12 22L3 17V7L12 2Z' stroke='%23F26423' stroke-width='2.5' stroke-linejoin='miter'/%3E%3C/svg%3E");
    background-size: contain;
    background-repeat: no-repeat;
}

/* Step code styling for inline code paths */
.step-code {
    background: #2C2C2C;
    color: #F1BC1B;
    padding: 0.25rem 0.5rem;
    font-family: 'Courier New', monospace;
    font-size: 0.875rem;
}
</style>
